# config.yaml
#config/config.yaml - AIç³»ç»Ÿæ ¸å¿ƒé…ç½®æ–‡ä»¶
#--- æ¨¡å‹é€šç”¨é…ç½® ---
llm:
    
    #ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ LLM (ä¾‹å¦‚ç”¨äºå†³ç­–å’Œæœ€ç»ˆå›å¤)
    prod_model:
        name: "gpt-3.5-turbo"
        provider: "openai"       # å¯¹åº” factory/llm_factory.py ä¸­çš„æ˜ å°„
        temperature: 0.7
        max_tokens: 4000
    
    #ç”¨äº RAG æ€»ç»“æˆ–æ„å›¾è¯†åˆ«çš„ LLM
    summary_model:
        name: "Qwen/Qwen3-1.7B"
        provider: "huggingface"  # å¯¹åº” factory/llm_factory.py ä¸­çš„æ˜ å°„
        pipeline_url: "http://localhost:8000/v1" # æœ¬åœ°éƒ¨ç½² LLM çš„ API åœ°å€
        temperature: 0.5

#--- åµŒå…¥æ¨¡å‹é…ç½® (RAG) ---
embedding:

    #æ–‡æœ¬å—åµŒå…¥æ¨¡å‹
    text_embedding:
        name: "text-embedding-ada-002"
        provider: "openai"       # å¯¹åº” factory/embedding_factory.py ä¸­çš„æ˜ å°„
        
    #çŸ¥è¯†å›¾è°±/ä¸“ä¸šé¢†åŸŸåµŒå…¥æ¨¡å‹ (ä»¥ HuggingFace BGE ä¸ºä¾‹)
    bge_embedding:
        name: "BAAI/bge-small-zh-v1.5"
        provider: "huggingface"

#--- å·¥å…·é…ç½® ---
tools:

    #æ•°å­¦è®¡ç®—å·¥å…·
    math_solver:
        type: "calculator"
        version: "v2.1"
    
    #å¤–éƒ¨ç½‘ç»œæœç´¢å·¥å…·
    web_search:
        type: "search"
        api_url: "https://search.api/v1"

#--- RAG é…ç½® ---
rag:
    primary_vector_store:
        type: "chroma"
        db_path: "./vector_storage/prod"
        # collection_name: "main_knowledge"
        collection_name: "project_knowledge_base"
        search_k: 5
        # ä¾èµ–æ³¨å…¥é…ç½®
        dependencies:
            embed_key: "text_embedding" # ä¾èµ– EmbeddingFactory ä¸­çš„ 'text_embedding'
            

#--- agenté…ç½® ---
agents:
    primary_router:
        type: "router"              # å¯¹åº” AgentFactory ä¸­çš„ AGENT_MAP é”®
        name: "MainRouter"
        # ä¾èµ–æ³¨å…¥é…ç½®ï¼šå£°æ˜ Agent éœ€è¦å“ªäº›ç»„ä»¶
        dependencies:
            llm_key: "prod_model"     # ä¾èµ– LLMFactory ä¸­çš„ 'prod_model'
            tools_keys: ["web_search", "math_solver"]               # ä¾èµ– ToolsFactory ä¸­çš„è¿™äº›å·¥å…·
            # rag_key: "primary_vector_store"     # ä¾èµ– ragFactory ä¸­çš„ 'primary_vector_store'
            # ğŸ†• å£°æ˜ RouterAgent ä¾èµ–çš„å­ Agent å®ä¾‹ (AgentFactory ä¼šé€’å½’åˆ›å»ºå®ƒä»¬)
            executor_keys: ["rag_executor", "calc_executor"]

    primary_rag_agent: # <-- æ–°å¢ RAG Agent é…ç½®
        type: "rag"
        name: "DocumentAnswerer"
        dependencies:
            llm_key: "summary_model"
            rag_key: "primary_vector_store" # ä¾èµ– RAGFactory ä¸­çš„ 'primary_vector_store'
            tools_keys: ["math_solver"] # RAG Agent ä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·
        


    # æ–°å¢ RAG æµç¨‹æ‰§è¡Œ Agent
    rag_executor:
        type: "rag"
        name: "RAGExecutorAgent"
        dependencies:
            llm_key: "summary_model"    # ä¾èµ– LLMFactory ä¸­çš„ 'summary_model' (ä¸“é—¨ç”¨äºæ€»ç»“)
            rag_key: "primary_vector_store" # ä¾èµ– RAGFactory ä¸­çš„ RAGModule å®ä¾‹

    # æ–°å¢ Calculator Tool æ‰§è¡Œ Agent
    calc_executor:
        type: "calculator"
        name: "CalculatorExecutorAgent"
        dependencies:
            llm_key: "summary_model"    # ä¾èµ– LLMFactory ä¸­çš„ 'summary_model' (ä¸“é—¨ç”¨äºæ ¼å¼åŒ–è¾“å‡º)
            tools_keys: ["math_solver"] # ä¾èµ– ToolsFactory ä¸­çš„ 'math_solver' (CalculatorAgent å®é™…è¿è¡Œçš„ Tool)
            
        # Agent è‡ªèº«å‚æ•°
        routing_threshold: 0.8



